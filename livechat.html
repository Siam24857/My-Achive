<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Worldwide Live Chat</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* CSS will go here */
        :root {
            --primary-color: #4285f4;
            --secondary-color: #34a853;
            --accent-color: #ea4335;
            --light-color: #f8f9fa;
            --dark-color: #202124;
            --gray-color: #5f6368;
            --bg-color: #ffffff;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background-color: var(--light-color);
            color: var(--dark-color);
            line-height: 1.6;
        }

        .chat-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            height: 100vh;
            box-shadow: var(--shadow);
            background-color: var(--bg-color);
            overflow: hidden;
        }

        .sidebar {
            width: 300px;
            background-color: var(--dark-color);
            color: var(--light-color);
            border-right: 1px solid #3c4043;
            display: flex;
            flex-direction: column;
        }

        .header {
            padding: 15px;
            background-color: var(--primary-color);
            text-align: center;
            font-weight: 500;
        }

        .user-list {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
        }

        .user {
            display: flex;
            align-items: center;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 5px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .user:hover {
            background-color: #3c4043;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
        }

        .user-info {
            flex: 1;
        }

        .user-name {
            font-weight: 500;
        }

        .user-status {
            font-size: 12px;
            color: var(--gray-color);
        }

        .online {
            color: var(--secondary-color);
        }

        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            padding: 15px;
            border-bottom: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
        }

        .chat-title {
            font-weight: 500;
            font-size: 18px;
        }

        .messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background-color: #f5f5f5;
        }

        .message {
            display: flex;
            margin-bottom: 15px;
            max-width: 70%;
        }

        .message.received {
            align-self: flex-start;
        }

        .message.sent {
            align-self: flex-end;
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background-color: var(--accent-color);
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 10px;
            font-weight: bold;
            color: white;
            font-size: 14px;
        }

        .message-content {
            padding: 10px 15px;
            border-radius: 18px;
            position: relative;
        }

        .received .message-content {
            background-color: white;
            color: var(--dark-color);
        }

        .sent .message-content {
            background-color: var(--primary-color);
            color: white;
        }

        .message-info {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            margin-top: 5px;
        }

        .received .message-info {
            color: var(--gray-color);
        }

        .sent .message-info {
            color: rgba(255, 255, 255, 0.7);
        }

        .message-time {
            margin-left: 10px;
        }

        .input-area {
            padding: 15px;
            border-top: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            background-color: white;
        }

        .message-input {
            flex: 1;
            padding: 12px 15px;
            border: 1px solid #e0e0e0;
            border-radius: 24px;
            outline: none;
            font-size: 16px;
            transition: border 0.3s;
        }

        .message-input:focus {
            border-color: var(--primary-color);
        }

        .send-button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 50%;
            width: 48px;
            height: 48px;
            margin-left: 10px;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        .send-button:hover {
            background-color: #3367d6;
        }

        .settings-button {
            background: none;
            border: none;
            color: var(--gray-color);
            font-size: 20px;
            cursor: pointer;
            margin-left: auto;
        }

        .country-flag {
            width: 20px;
            height: 15px;
            margin-right: 10px;
            border-radius: 2px;
        }

        /* Responsive design */
        @media (max-width: 768px) {
            .chat-container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <!-- Sidebar with user list -->
        <div class="sidebar">
            <div class="header">
                <h2>Worldwide Chat</h2>
            </div>
            <div class="user-list" id="userList">
                <!-- Users will be populated here -->
            </div>
        </div>

        <!-- Main chat area -->
        <div class="chat-area">
            <div class="chat-header">
                <div class="chat-title">Global Chat Room</div>
                <button class="settings-button" id="settingsButton">
                    <i class="fas fa-cog"></i>
                </button>
            </div>

            <div class="messages" id="messages">
                <!-- Messages will be displayed here -->
            </div>

            <div class="input-area">
                <input type="text" class="message-input" id="messageInput" placeholder="Type your message here...">
                <button class="send-button" id="sendButton">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <script>
        // JavaScript will go here
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const messageInput = document.getElementById('messageInput');
            const sendButton = document.getElementById('sendButton');
            const messagesContainer = document.getElementById('messages');
            const userList = document.getElementById('userList');
            const settingsButton = document.getElementById('settingsButton');
            
            // User data
            let currentUser = {
                id: generateId(),
                name: generateRandomName(),
                country: getRandomCountry(),
                avatar: generateAvatarInitials()
            };
            
            // Load previous messages from local storage
            let messages = JSON.parse(localStorage.getItem('worldwideChatMessages')) || [];
            
            // Sample users data (in a real app, this would come from a server)
            let users = generateRandomUsers(15);
            users.unshift(currentUser); // Add current user to the list
            
            // Initialize the app
            renderMessages();
            renderUserList();
            
            // Event listeners
            sendButton.addEventListener('click', sendMessage);
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });
            
            settingsButton.addEventListener('click', function() {
                const newName = prompt('Enter your new name:', currentUser.name);
                if (newName && newName.trim() !== '') {
                    currentUser.name = newName.trim();
                    currentUser.avatar = generateAvatarInitials(newName.trim());
                    localStorage.setItem('worldwideChatUser', JSON.stringify(currentUser));
                    renderUserList();
                }
            });
            
            // Functions
            function sendMessage() {
                const messageText = messageInput.value.trim();
                if (messageText === '') return;
                
                const newMessage = {
                    id: generateId(),
                    text: messageText,
                    sender: currentUser,
                    timestamp: new Date().toISOString(),
                    isCurrentUser: true
                };
                
                messages.push(newMessage);
                saveMessages();
                renderMessages();
                messageInput.value = '';
                
                // Simulate receiving a message after a delay
                setTimeout(() => {
                    const randomUser = users[Math.floor(Math.random() * (users.length - 1)) + 1];
                    const responses = [
                        "Hello there!",
                        "How are you?",
                        "That's interesting!",
                        "I agree with you.",
                        "Where are you from?",
                        "Nice to meet you!",
                        "What's your favorite food?",
                        "The weather is nice today.",
                        "Have you been to my country?",
                        "Let's be friends!"
                    ];
                    
                    const replyMessage = {
                        id: generateId(),
                        text: responses[Math.floor(Math.random() * responses.length)],
                        sender: randomUser,
                        timestamp: new Date().toISOString(),
                        isCurrentUser: false
                    };
                    
                    messages.push(replyMessage);
                    saveMessages();
                    renderMessages();
                }, 1000 + Math.random() * 3000);
            }
            
            function renderMessages() {
                messagesContainer.innerHTML = '';
                
                messages.forEach(message => {
                    const messageElement = document.createElement('div');
                    messageElement.className = `message ${message.isCurrentUser ? 'sent' : 'received'}`;
                    
                    const avatar = document.createElement('div');
                    avatar.className = 'message-avatar';
                    avatar.textContent = message.sender.avatar;
                    
                    const content = document.createElement('div');
                    content.className = 'message-content';
                    content.textContent = message.text;
                    
                    const info = document.createElement('div');
                    info.className = 'message-info';
                    
                    const senderName = document.createElement('span');
                    senderName.className = 'message-sender';
                    senderName.textContent = message.isCurrentUser ? 'You' : message.sender.name;
                    
                    const time = document.createElement('span');
                    time.className = 'message-time';
                    time.textContent = formatTime(message.timestamp);
                    
                    info.appendChild(senderName);
                    info.appendChild(time);
                    
                    content.appendChild(info);
                    
                    messageElement.appendChild(avatar);
                    messageElement.appendChild(content);
                    
                    messagesContainer.appendChild(messageElement);
                });
                
                // Scroll to bottom
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }
            
            function renderUserList() {
                userList.innerHTML = '';
                
                users.forEach(user => {
                    const userElement = document.createElement('div');
                    userElement.className = `user ${user.id === currentUser.id ? 'current-user' : ''}`;
                    
                    const avatar = document.createElement('div');
                    avatar.className = 'user-avatar';
                    avatar.textContent = user.avatar;
                    
                    const info = document.createElement('div');
                    info.className = 'user-info';
                    
                    const name = document.createElement('div');
                    name.className = 'user-name';
                    name.textContent = user.name;
                    
                    const status = document.createElement('div');
                    status.className = 'user-status online';
                    status.textContent = 'Online';
                    
                    info.appendChild(name);
                    info.appendChild(status);
                    
                    userElement.appendChild(avatar);
                    userElement.appendChild(info);
                    
                    // Add country flag if not current user
                    if (user.id !== currentUser.id) {
                        const flag = document.createElement('img');
                        flag.className = 'country-flag';
                        flag.src = `https://flagcdn.com/w20/${user.country.code.toLowerCase()}.png`;
                        flag.alt = user.country.name;
                        flag.title = user.country.name;
                        userElement.insertBefore(flag, info);
                    }
                    
                    userList.appendChild(userElement);
                });
            }
            
            function saveMessages() {
                localStorage.setItem('worldwideChatMessages', JSON.stringify(messages));
            }
            
            function formatTime(timestamp) {
                const date = new Date(timestamp);
                return date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
            }
            
            // Utility functions
            function generateId() {
                return Math.random().toString(36).substr(2, 9);
            }
            
            function generateRandomName() {
                const firstNames = ['Alex', 'Jordan', 'Taylor', 'Casey', 'Morgan', 'Riley', 'Jamie', 'Quinn', 'Avery', 'Peyton', 'Dakota', 'Skyler', 'Rowan', 'Charlie', 'Emerson'];
                const lastNames = ['Smith', 'Johnson', 'Williams', 'Brown', 'Jones', 'Garcia', 'Miller', 'Davis', 'Rodriguez', 'Martinez', 'Hernandez', 'Lopez', 'Gonzalez', 'Wilson', 'Anderson'];
                
                return `${firstNames[Math.floor(Math.random() * firstNames.length)]} ${lastNames[Math.floor(Math.random() * lastNames.length)]}`;
            }
            
            function generateAvatarInitials(name = null) {
                if (!name) name = currentUser.name;
                const parts = name.split(' ');
                return parts.length >= 2 
                    ? `${parts[0][0]}${parts[parts.length - 1][0]}`.toUpperCase()
                    : name.substring(0, 2).toUpperCase();
            }
            
            function getRandomCountry() {
                const countries = [
                    { name: 'United States', code: 'US' },
                    { name: 'United Kingdom', code: 'GB' },
                    { name: 'Canada', code: 'CA' },
                    { name: 'Australia', code: 'AU' },
                    { name: 'Germany', code: 'DE' },
                    { name: 'France', code: 'FR' },
                    { name: 'Japan', code: 'JP' },
                    { name: 'Brazil', code: 'BR' },
                    { name: 'India', code: 'IN' },
                    { name: 'China', code: 'CN' },
                    { name: 'Mexico', code: 'MX' },
                    { name: 'Italy', code: 'IT' },
                    { name: 'Spain', code: 'ES' },
                    { name: 'South Korea', code: 'KR' },
                    { name: 'Russia', code: 'RU' }
                ];
                
                return countries[Math.floor(Math.random() * countries.length)];
            }
            
            function generateRandomUsers(count) {
                const users = [];
                for (let i = 0; i < count; i++) {
                    const name = generateRandomName();
                    users.push({
                        id: generateId(),
                        name: name,
                        country: getRandomCountry(),
                        avatar: generateAvatarInitials(name)
                    });
                }
                return users;
            }
            
            // Check if user data exists in local storage
            const savedUser = localStorage.getItem('worldwideChatUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
            } else {
                localStorage.setItem('worldwideChatUser', JSON.stringify(currentUser));
            }
        });
    </script>
</body>
</html>